<Window x:Class="UITestKit.RecorderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:UITestKit"
        Title="Recorder" Height="600" Width="1000">
    <DockPanel>
        <!-- Top Button Bar -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
            <Button Content="Close All" Width="100" Margin="5,0,0,0" Click="BtnCloseAll_Click"/>
            <Button Content="Submit" Width="100" Margin="5,0,0,0" Click="BtnSubmit_Click"/>
            <Button Content="Add Stage" Width="100" Margin="5,0,0,0" Click="BtnAddStage_Click"/>
            <Button Content="Update Stage" Width="100" Margin="5,0,0,0" Click="BtnUpdateStage_Click"/>
            <Button Content="Delete Stage" Width="100" Margin="5,0,0,0" Click="BtnDeleteStage_Click"/>
        </StackPanel>

        <!-- Stage Selection ComboBox -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
            <Label Content="Select Stage:" Margin="5,0,0,0" VerticalAlignment="Center"/>
            <ComboBox x:Name="cmbStages"
                      ItemsSource="{Binding StageKeys}"
                      SelectedValue="{Binding SelectedStageKey, Mode=TwoWay}"
                      SelectionChanged="CmbStages_SelectionChanged"
                      Width="200"
                      VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Main Content Area - Split Top/Bottom -->
        <Grid Margin="5">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="5"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Top Half - Input Client -->
            <GroupBox Grid.Row="0" Header="Input Client" Margin="0,0,0,5">
                <DataGrid ItemsSource="{Binding SelectedStageData.InputClients, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="True"
                          CanUserDeleteRows="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Stage" 
                                            Binding="{Binding Stage, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            Width="70" 
                                            IsReadOnly="False"/>
                        <DataGridTextColumn Header="Action" 
                                            Binding="{Binding Action, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            Width="120" 
                                            IsReadOnly="False"/>
                        <DataGridTextColumn Header="Input" 
                                            Binding="{Binding Input, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            Width="*" 
                                            IsReadOnly="False"/>
                        <DataGridTextColumn Header="DataType" 
                                            Binding="{Binding DataType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            Width="150" 
                                            IsReadOnly="False"/>
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>

            <!-- Splitter -->
            <GridSplitter Grid.Row="1" 
                          Height="5" 
                          HorizontalAlignment="Stretch" 
                          VerticalAlignment="Center"
                          Background="LightGray"
                          ShowsPreview="True"/>

            <!-- Bottom Half - Output Tabs -->
            <GroupBox Grid.Row="2" Header="Outputs" Margin="0,5,0,0">
                <TabControl>
                    <!-- Output Client Tab -->
                    <TabItem Header="Output Client">
                        <DataGrid ItemsSource="{Binding SelectedStageData.OutputClients, Mode=TwoWay}"
                                  IsReadOnly="False"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Stage" Binding="{Binding Stage}" Width="60"/>
                                <DataGridTextColumn Header="Method" Binding="{Binding Method}" Width="80"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding StatusCode}" Width="70"/>
                                <DataGridTextColumn Header="DataResponse" Binding="{Binding DataResponse}" Width="150"/>
                                <DataGridTextColumn Header="Output" Binding="{Binding Output}" Width="*">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="TextWrapping" Value="Wrap"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="DataType" Binding="{Binding DataTypeMiddleWare}" Width="120"/>
                                <DataGridTextColumn Header="Bytes" Binding="{Binding ByteSize}" Width="80"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </TabItem>

                    <!-- Output Server Tab -->
                    <TabItem Header="Output Server">
                        <DataGrid ItemsSource="{Binding SelectedStageData.OutputServers, Mode=TwoWay}"
                                  IsReadOnly="False"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Stage" Binding="{Binding Stage}" Width="60"/>
                                <DataGridTextColumn Header="Method" Binding="{Binding Method}" Width="80"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding StatusCode}" Width="70"/>
                                <DataGridTextColumn Header="DataRequest" Binding="{Binding DataRequest}" Width="150"/>
                                <DataGridTextColumn Header="Output" Binding="{Binding Output}" Width="*">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="TextWrapping" Value="Wrap"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="DataType" Binding="{Binding DataTypeMiddleWare}" Width="120"/>
                                <DataGridTextColumn Header="Bytes" Binding="{Binding ByteSize}" Width="80"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </TabItem>
                </TabControl>
            </GroupBox>
        </Grid>
    </DockPanel>
</Window>